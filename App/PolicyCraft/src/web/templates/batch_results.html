{% extends "base.html" %}

{% block title %}Batch Analysis Results - PolicyCraft{% endblock %}

{% block content %}
<div class="batch-results-container">
    <div class="batch-header">
        <h1>Batch Analysis Results</h1>
        <p>Analysis completed on {{ data.analysis_date }}</p>
    </div>
    
    <!-- Summary Statistics -->
    <div class="batch-summary">
        <div class="summary-cards">
            <div class="summary-card success">
                <div class="card-icon">‚úÖ</div>
                <div class="card-content">
                    <h3>{{ data.summary.successful }}</h3>
                    <p>Successful Analyses</p>
                </div>
            </div>
            
            <div class="summary-card error">
                <div class="card-icon">‚ùå</div>
                <div class="card-content">
                    <h3>{{ data.summary.failed }}</h3>
                    <p>Failed Analyses</p>
                </div>
            </div>
            
            <div class="summary-card info">
                <div class="card-icon">üìä</div>
                <div class="card-content">
                    <h3>{{ "%.1f"|format(data.summary.avg_confidence) }}%</h3>
                    <p>Average Confidence</p>
                </div>
            </div>
            
            <div class="summary-card total">
                <div class="card-icon">üìÑ</div>
                <div class="card-content">
                    <h3>{{ data.summary.total_files }}</h3>
                    <p>Total Files</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Classification Overview -->
    {% if data.summary.classification_summary %}
    <div class="classification-overview">
        <h2>Classification Distribution</h2>
        <div class="classification-chart">
            {% for classification, count in data.summary.classification_summary.items() %}
            <div class="classification-bar">
                <span class="classification-label">{{ classification }}</span>
                <div class="bar-container">
                    <div class="bar bar-{{ classification.lower() }}" 
                         style="width: {{ (count / data.summary.successful * 100) if data.summary.successful > 0 else 0 }}%"></div>
                    <span class="bar-value">{{ count }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Top Themes -->
    {% if data.summary.theme_summary %}
    <div class="themes-overview">
        <h2>Most Common Themes</h2>
        <div class="themes-grid">
            {% for theme, count in data.summary.theme_summary.items() %}
            <div class="theme-badge">
                <span class="theme-name">{{ theme }}</span>
                <span class="theme-count">{{ count }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Individual Results -->
    <div class="individual-results">
        <h2>Individual Analysis Results</h2>
        
        <div class="results-grid">
            {% for result in data.results %}
            <div class="result-card {{ 'success' if result.status == 'success' else 'error' }}">
                <div class="result-header">
                    <h3>{{ result.original_filename }}</h3>
                    <span class="status-badge status-{{ result.status }}